1. Which countries have the most Invoices?

Use the Invoice table to determine the countries that have the most invoices. Provide a table of BillingCountry and Invoices ordered by the number of invoices for each country. The country with the most invoices should appear first.

Query#1:
SELECT BillingCountry, COUNT(*) AS Invoices
FROM Invoice
GROUP BY BillingCountry
ORDER BY Invoices DESC, BillingCountry;

2. Which city has the best customers?

We want to throw a promotional Music Festival in the city we made the most money. Write a query that returns the 1 city that has the highest sum of invoice totals. Return both the city name and the sum of all invoice totals.

Query#2:
SELECT BillingCity, SUM(Total) AS TotalRevenue
FROM Invoice
GROUP BY BillingCity
ORDER BY TotalRevenue DESC
LIMIT 1;

3. Who is the best customer?

The customer who has spent the most money will be declared the best customer. Build a query that returns the person who has spent the most money. I found the solution by linking the following three: Invoice, InvoiceLine, and Customer tables to retrieve this information, but you can probably do it with fewer!

Query#3
SELECT
    'Customer ' || C.CustomerId AS CustomerName,
    SUM(IL.UnitPrice * IL.Quantity) AS TotalSpent
FROM
    Customer AS C
JOIN
    Invoice AS I ON C.CustomerId = I.CustomerId
JOIN
    InvoiceLine AS IL ON I.InvoiceId = IL.InvoiceId
GROUP BY
    C.CustomerId
ORDER BY
    TotalSpent DESC
LIMIT 1;
